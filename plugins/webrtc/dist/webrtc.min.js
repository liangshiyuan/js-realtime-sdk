!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("leancloud-realtime")):"function"==typeof define&&define.amd?define("webrtc",["exports","leancloud-realtime"],e):e((t=t||self).AV=t.AV||{},t.AV)}(this,(function(t,e){"use strict";var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function r(t,e){return t(e={exports:{}},e.exports),e.exports}var o=r((function(t){var e=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e)})),i=r((function(t){var e=t.exports={version:"2.6.5"};"number"==typeof __e&&(__e=e)})),c=(i.version,function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}),a=function(t,e,n){if(c(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,o){return t.call(e,n,r,o)}}return function(){return t.apply(e,arguments)}},s=function(t){return"object"==typeof t?null!==t:"function"==typeof t},u=function(t){if(!s(t))throw TypeError(t+" is not an object!");return t},f=function(t){try{return!!t()}catch(t){return!0}},l=!f((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})),h=o.document,p=s(h)&&s(h.createElement),v=function(t){return p?h.createElement(t):{}},d=!l&&!f((function(){return 7!=Object.defineProperty(v("div"),"a",{get:function(){return 7}}).a})),y=function(t,e){if(!s(t))return t;var n,r;if(e&&"function"==typeof(n=t.toString)&&!s(r=n.call(t)))return r;if("function"==typeof(n=t.valueOf)&&!s(r=n.call(t)))return r;if(!e&&"function"==typeof(n=t.toString)&&!s(r=n.call(t)))return r;throw TypeError("Can't convert object to primitive value")},_=Object.defineProperty,m={f:l?Object.defineProperty:function(t,e,n){if(u(t),e=y(e,!0),u(n),d)try{return _(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},g=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},b=l?function(t,e,n){return m.f(t,e,g(1,n))}:function(t,e,n){return t[e]=n,t},w={}.hasOwnProperty,C=function(t,e){return w.call(t,e)},S=function(t,e,n){var r,c,s,u=t&S.F,f=t&S.G,l=t&S.S,h=t&S.P,p=t&S.B,v=t&S.W,d=f?i:i[e]||(i[e]={}),y=d.prototype,_=f?o:l?o[e]:(o[e]||{}).prototype;for(r in f&&(n=e),n)(c=!u&&_&&void 0!==_[r])&&C(d,r)||(s=c?_[r]:n[r],d[r]=f&&"function"!=typeof _[r]?n[r]:p&&c?a(s,o):v&&_[r]==s?function(t){var e=function(e,n,r){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,n)}return new t(e,n,r)}return t.apply(this,arguments)};return e.prototype=t.prototype,e}(s):h&&"function"==typeof s?a(Function.call,s):s,h&&((d.virtual||(d.virtual={}))[r]=s,t&S.R&&y&&!y[r]&&b(y,r,s)))};S.F=1,S.G=2,S.S=4,S.P=8,S.B=16,S.W=32,S.U=64,S.R=128;var O=S;O(O.S+O.F*!l,"Object",{defineProperty:m.f});var E,A=i.Object,P=function(t,e,n){return A.defineProperty(t,e,n)},j={}.toString,T=function(t){return j.call(t).slice(8,-1)},I=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==T(t)?t.split(""):Object(t)},x=function(t){if(null==t)throw TypeError("Can't call method on  "+t);return t},L=function(t){return I(x(t))},R=Math.ceil,D=Math.floor,N=function(t){return isNaN(t=+t)?0:(t>0?D:R)(t)},k=Math.min,M=function(t){return t>0?k(N(t),9007199254740991):0},F=Math.max,W=Math.min,V=r((function(t){var e=o["__core-js_shared__"]||(o["__core-js_shared__"]={});(t.exports=function(t,n){return e[t]||(e[t]=void 0!==n?n:{})})("versions",[]).push({version:i.version,mode:"pure",copyright:"Â© 2019 Denis Pushkarev (zloirock.ru)"})})),G=0,K=Math.random(),Y=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++G+K).toString(36))},B=V("keys"),U=function(t){return B[t]||(B[t]=Y(t))},q=(E=!1,function(t,e,n){var r,o=L(t),i=M(o.length),c=function(t,e){return(t=N(t))<0?F(t+e,0):W(t,e)}(n,i);if(E&&e!=e){for(;i>c;)if((r=o[c++])!=r)return!0}else for(;i>c;c++)if((E||c in o)&&o[c]===e)return E||c||0;return!E&&-1}),H=U("IE_PROTO"),z=function(t,e){var n,r=L(t),o=0,i=[];for(n in r)n!=H&&C(r,n)&&i.push(n);for(;e.length>o;)C(r,n=e[o++])&&(~q(i,n)||i.push(n));return i},J="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),Q=Object.keys||function(t){return z(t,J)},$=l?Object.defineProperties:function(t,e){u(t);for(var n,r=Q(e),o=r.length,i=0;o>i;)m.f(t,n=r[i++],e[n]);return t};O(O.S+O.F*!l,"Object",{defineProperties:$});var X=i.Object,Z=function(t,e){return X.defineProperties(t,e)},tt=J.concat("length","prototype"),et={f:Object.getOwnPropertyNames||function(t){return z(t,tt)}},nt={f:Object.getOwnPropertySymbols},rt=o.Reflect,ot=rt&&rt.ownKeys||function(t){var e=et.f(u(t)),n=nt.f;return n?e.concat(n(t)):e},it={f:{}.propertyIsEnumerable},ct=Object.getOwnPropertyDescriptor,at={f:l?ct:function(t,e){if(t=L(t),e=y(e,!0),d)try{return ct(t,e)}catch(t){}if(C(t,e))return g(!it.f.call(t,e),t[e])}},st=function(t,e,n){e in t?m.f(t,e,g(0,n)):t[e]=n};O(O.S,"Object",{getOwnPropertyDescriptors:function(t){for(var e,n,r=L(t),o=at.f,i=ot(r),c={},a=0;i.length>a;)void 0!==(n=o(r,e=i[a++]))&&st(c,e,n);return c}});var ut=i.Object.getOwnPropertyDescriptors,ft=function(t,e){var n=(i.Object||{})[t]||Object[t],r={};r[t]=e(n),O(O.S+O.F*f((function(){n(1)})),"Object",r)},lt=at.f;ft("getOwnPropertyDescriptor",(function(){return function(t,e){return lt(L(t),e)}}));var ht=i.Object,pt=function(t,e){return ht.getOwnPropertyDescriptor(t,e)},vt=b,dt=r((function(t){var e=Y("meta"),n=m.f,r=0,o=Object.isExtensible||function(){return!0},i=!f((function(){return o(Object.preventExtensions({}))})),c=function(t){n(t,e,{value:{i:"O"+ ++r,w:{}}})},a=t.exports={KEY:e,NEED:!1,fastKey:function(t,n){if(!s(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!C(t,e)){if(!o(t))return"F";if(!n)return"E";c(t)}return t[e].i},getWeak:function(t,n){if(!C(t,e)){if(!o(t))return!0;if(!n)return!1;c(t)}return t[e].w},onFreeze:function(t){return i&&a.NEED&&o(t)&&!C(t,e)&&c(t),t}}})),yt=(dt.KEY,dt.NEED,dt.fastKey,dt.getWeak,dt.onFreeze,r((function(t){var e=V("wks"),n=o.Symbol,r="function"==typeof n;(t.exports=function(t){return e[t]||(e[t]=r&&n[t]||(r?n:Y)("Symbol."+t))}).store=e}))),_t=m.f,mt=yt("toStringTag"),gt=function(t,e,n){t&&!C(t=n?t:t.prototype,mt)&&_t(t,mt,{configurable:!0,value:e})},bt={f:yt},wt=m.f,Ct=function(t){var e=i.Symbol||(i.Symbol={});"_"==t.charAt(0)||t in e||wt(e,t,{value:bt.f(t)})},St=Array.isArray||function(t){return"Array"==T(t)},Ot=o.document,Et=Ot&&Ot.documentElement,At=U("IE_PROTO"),Pt=function(){},jt=function(){var t,e=v("iframe"),n=J.length;for(e.style.display="none",Et.appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),jt=t.F;n--;)delete jt.prototype[J[n]];return jt()},Tt=Object.create||function(t,e){var n;return null!==t?(Pt.prototype=u(t),n=new Pt,Pt.prototype=null,n[At]=t):n=jt(),void 0===e?n:$(n,e)},It=et.f,xt={}.toString,Lt="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],Rt={f:function(t){return Lt&&"[object Window]"==xt.call(t)?function(t){try{return It(t)}catch(t){return Lt.slice()}}(t):It(L(t))}},Dt=dt.KEY,Nt=at.f,kt=m.f,Mt=Rt.f,Ft=o.Symbol,Wt=o.JSON,Vt=Wt&&Wt.stringify,Gt=yt("_hidden"),Kt=yt("toPrimitive"),Yt={}.propertyIsEnumerable,Bt=V("symbol-registry"),Ut=V("symbols"),qt=V("op-symbols"),Ht=Object.prototype,zt="function"==typeof Ft,Jt=o.QObject,Qt=!Jt||!Jt.prototype||!Jt.prototype.findChild,$t=l&&f((function(){return 7!=Tt(kt({},"a",{get:function(){return kt(this,"a",{value:7}).a}})).a}))?function(t,e,n){var r=Nt(Ht,e);r&&delete Ht[e],kt(t,e,n),r&&t!==Ht&&kt(Ht,e,r)}:kt,Xt=function(t){var e=Ut[t]=Tt(Ft.prototype);return e._k=t,e},Zt=zt&&"symbol"==typeof Ft.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof Ft},te=function(t,e,n){return t===Ht&&te(qt,e,n),u(t),e=y(e,!0),u(n),C(Ut,e)?(n.enumerable?(C(t,Gt)&&t[Gt][e]&&(t[Gt][e]=!1),n=Tt(n,{enumerable:g(0,!1)})):(C(t,Gt)||kt(t,Gt,g(1,{})),t[Gt][e]=!0),$t(t,e,n)):kt(t,e,n)},ee=function(t,e){u(t);for(var n,r=function(t){var e=Q(t),n=nt.f;if(n)for(var r,o=n(t),i=it.f,c=0;o.length>c;)i.call(t,r=o[c++])&&e.push(r);return e}(e=L(e)),o=0,i=r.length;i>o;)te(t,n=r[o++],e[n]);return t},ne=function(t){var e=Yt.call(this,t=y(t,!0));return!(this===Ht&&C(Ut,t)&&!C(qt,t))&&(!(e||!C(this,t)||!C(Ut,t)||C(this,Gt)&&this[Gt][t])||e)},re=function(t,e){if(t=L(t),e=y(e,!0),t!==Ht||!C(Ut,e)||C(qt,e)){var n=Nt(t,e);return!n||!C(Ut,e)||C(t,Gt)&&t[Gt][e]||(n.enumerable=!0),n}},oe=function(t){for(var e,n=Mt(L(t)),r=[],o=0;n.length>o;)C(Ut,e=n[o++])||e==Gt||e==Dt||r.push(e);return r},ie=function(t){for(var e,n=t===Ht,r=Mt(n?qt:L(t)),o=[],i=0;r.length>i;)!C(Ut,e=r[i++])||n&&!C(Ht,e)||o.push(Ut[e]);return o};zt||(vt((Ft=function(){if(this instanceof Ft)throw TypeError("Symbol is not a constructor!");var t=Y(arguments.length>0?arguments[0]:void 0),e=function(n){this===Ht&&e.call(qt,n),C(this,Gt)&&C(this[Gt],t)&&(this[Gt][t]=!1),$t(this,t,g(1,n))};return l&&Qt&&$t(Ht,t,{configurable:!0,set:e}),Xt(t)}).prototype,"toString",(function(){return this._k})),at.f=re,m.f=te,et.f=Rt.f=oe,it.f=ne,nt.f=ie,bt.f=function(t){return Xt(yt(t))}),O(O.G+O.W+O.F*!zt,{Symbol:Ft});for(var ce="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),ae=0;ce.length>ae;)yt(ce[ae++]);for(var se=Q(yt.store),ue=0;se.length>ue;)Ct(se[ue++]);O(O.S+O.F*!zt,"Symbol",{for:function(t){return C(Bt,t+="")?Bt[t]:Bt[t]=Ft(t)},keyFor:function(t){if(!Zt(t))throw TypeError(t+" is not a symbol!");for(var e in Bt)if(Bt[e]===t)return e},useSetter:function(){Qt=!0},useSimple:function(){Qt=!1}}),O(O.S+O.F*!zt,"Object",{create:function(t,e){return void 0===e?Tt(t):ee(Tt(t),e)},defineProperty:te,defineProperties:ee,getOwnPropertyDescriptor:re,getOwnPropertyNames:oe,getOwnPropertySymbols:ie}),Wt&&O(O.S+O.F*(!zt||f((function(){var t=Ft();return"[null]"!=Vt([t])||"{}"!=Vt({a:t})||"{}"!=Vt(Object(t))}))),"JSON",{stringify:function(t){for(var e,n,r=[t],o=1;arguments.length>o;)r.push(arguments[o++]);if(n=e=r[1],(s(e)||void 0!==t)&&!Zt(t))return St(e)||(e=function(t,e){if("function"==typeof n&&(e=n.call(this,t,e)),!Zt(e))return e}),r[1]=e,Vt.apply(Wt,r)}}),Ft.prototype[Kt]||b(Ft.prototype,Kt,Ft.prototype.valueOf),gt(Ft,"Symbol"),gt(Math,"Math",!0),gt(o.JSON,"JSON",!0);var fe=i.Object.getOwnPropertySymbols,le=function(t){return Object(x(t))};ft("keys",(function(){return function(t){return Q(le(t))}}));var he=i.Object.keys;O(O.S,"Array",{isArray:St});var pe=i.Array.isArray;var ve=function(t){if(pe(t))return t},de=function(t,e){return{value:e,done:!!t}},ye={},_e={};b(_e,yt("iterator"),(function(){return this}));var me=function(t,e,n){t.prototype=Tt(_e,{next:g(1,n)}),gt(t,e+" Iterator")},ge=U("IE_PROTO"),be=Object.prototype,we=Object.getPrototypeOf||function(t){return t=le(t),C(t,ge)?t[ge]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?be:null},Ce=yt("iterator"),Se=!([].keys&&"next"in[].keys()),Oe=function(){return this},Ee=function(t,e,n,r,o,i,c){me(n,e,r);var a,s,u,f=function(t){if(!Se&&t in v)return v[t];switch(t){case"keys":case"values":return function(){return new n(this,t)}}return function(){return new n(this,t)}},l=e+" Iterator",h="values"==o,p=!1,v=t.prototype,d=v[Ce]||v["@@iterator"]||o&&v[o],y=d||f(o),_=o?h?f("entries"):y:void 0,m="Array"==e&&v.entries||d;if(m&&(u=we(m.call(new t)))!==Object.prototype&&u.next&&gt(u,l,!0),h&&d&&"values"!==d.name&&(p=!0,y=function(){return d.call(this)}),c&&(Se||p||!v[Ce])&&b(v,Ce,y),ye[e]=y,ye[l]=Oe,o)if(a={values:h?y:f("values"),keys:i?y:f("keys"),entries:_},c)for(s in a)s in v||vt(v,s,a[s]);else O(O.P+O.F*(Se||p),e,a);return a};Ee(Array,"Array",(function(t,e){this._t=L(t),this._i=0,this._k=e}),(function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,de(1)):de(0,"keys"==e?n:"values"==e?t[n]:[n,t[n]])}),"values");ye.Arguments=ye.Array;for(var Ae=yt("toStringTag"),Pe="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),je=0;je<Pe.length;je++){var Te=Pe[je],Ie=o[Te],xe=Ie&&Ie.prototype;xe&&!xe[Ae]&&b(xe,Ae,Te),ye[Te]=ye.Array}var Le,Re=(Le=!0,function(t,e){var n,r,o=String(x(t)),i=N(e),c=o.length;return i<0||i>=c?Le?"":void 0:(n=o.charCodeAt(i))<55296||n>56319||i+1===c||(r=o.charCodeAt(i+1))<56320||r>57343?Le?o.charAt(i):n:Le?o.slice(i,i+2):r-56320+(n-55296<<10)+65536});Ee(String,"String",(function(t){this._t=String(t),this._i=0}),(function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=Re(e,n),this._i+=t.length,{value:t,done:!1})}));var De=yt("toStringTag"),Ne="Arguments"==T(function(){return arguments}()),ke=function(t){var e,n,r;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),De))?n:Ne?T(e):"Object"==(r=T(e))&&"function"==typeof e.callee?"Arguments":r},Me=yt("iterator"),Fe=i.getIteratorMethod=function(t){if(null!=t)return t[Me]||t["@@iterator"]||ye[ke(t)]},We=i.getIterator=function(t){var e=Fe(t);if("function"!=typeof e)throw TypeError(t+" is not iterable!");return u(e.call(t))},Ve=yt("iterator"),Ge=i.isIterable=function(t){var e=Object(t);return void 0!==e[Ve]||"@@iterator"in e||ye.hasOwnProperty(ke(e))};Ct("asyncIterator"),Ct("observable");var Ke=i.Symbol;var Ye=function(t,e){if(void 0!==Ke&&Ge(Object(t))){var n=[],r=!0,o=!1,i=void 0;try{for(var c,a=We(t);!(r=(c=a.next()).done)&&(n.push(c.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==a.return||a.return()}finally{if(o)throw i}}return n}},Be=function(t,e,n,r){try{return r?e(u(n)[0],n[1]):e(n)}catch(e){var o=t.return;throw void 0!==o&&u(o.call(t)),e}},Ue=yt("iterator"),qe=Array.prototype,He=function(t){return void 0!==t&&(ye.Array===t||qe[Ue]===t)},ze=yt("iterator"),Je=!1;try{var Qe=[7][ze]();Qe.return=function(){Je=!0},Array.from(Qe,(function(){throw 2}))}catch(t){}var $e=function(t,e){if(!e&&!Je)return!1;var n=!1;try{var r=[7],o=r[ze]();o.next=function(){return{done:n=!0}},r[ze]=function(){return o},t(r)}catch(t){}return n};O(O.S+O.F*!$e((function(t){Array.from(t)})),"Array",{from:function(t){var e,n,r,o,i=le(t),c="function"==typeof this?this:Array,s=arguments.length,u=s>1?arguments[1]:void 0,f=void 0!==u,l=0,h=Fe(i);if(f&&(u=a(u,s>2?arguments[2]:void 0,2)),null==h||c==Array&&He(h))for(n=new c(e=M(i.length));e>l;l++)st(n,l,f?u(i[l],l):i[l]);else for(o=h.call(i),n=new c;!(r=o.next()).done;l++)st(n,l,f?Be(o,u,[r.value,l],!0):r.value);return n.length=l,n}});var Xe=i.Array.from;var Ze=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r};var tn=function(t,e){if(t){if("string"==typeof t)return Ze(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Xe(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ze(t,e):void 0}};var en=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")};var nn,rn,on,cn=function(t,e){return ve(t)||Ye(t,e)||tn(t,e)||en()},an=r((function(t){var e={},n={},r=t.exports=function(t,r,o,i,c){var s,f,l,h,p=c?function(){return t}:Fe(t),v=a(o,i,r?2:1),d=0;if("function"!=typeof p)throw TypeError(t+" is not iterable!");if(He(p)){for(s=M(t.length);s>d;d++)if((h=r?v(u(f=t[d])[0],f[1]):v(t[d]))===e||h===n)return h}else for(l=p.call(t);!(f=l.next()).done;)if((h=Be(l,v,f.value,r))===e||h===n)return h};r.BREAK=e,r.RETURN=n})),sn=yt("species"),un=function(t,e){var n,r=u(t).constructor;return void 0===r||null==(n=u(r)[sn])?e:c(n)},fn=function(t,e,n){var r=void 0===n;switch(e.length){case 0:return r?t():t.call(n);case 1:return r?t(e[0]):t.call(n,e[0]);case 2:return r?t(e[0],e[1]):t.call(n,e[0],e[1]);case 3:return r?t(e[0],e[1],e[2]):t.call(n,e[0],e[1],e[2]);case 4:return r?t(e[0],e[1],e[2],e[3]):t.call(n,e[0],e[1],e[2],e[3])}return t.apply(n,e)},ln=o.process,hn=o.setImmediate,pn=o.clearImmediate,vn=o.MessageChannel,dn=o.Dispatch,yn=0,_n={},mn=function(){var t=+this;if(_n.hasOwnProperty(t)){var e=_n[t];delete _n[t],e()}},gn=function(t){mn.call(t.data)};hn&&pn||(hn=function(t){for(var e=[],n=1;arguments.length>n;)e.push(arguments[n++]);return _n[++yn]=function(){fn("function"==typeof t?t:Function(t),e)},nn(yn),yn},pn=function(t){delete _n[t]},"process"==T(ln)?nn=function(t){ln.nextTick(a(mn,t,1))}:dn&&dn.now?nn=function(t){dn.now(a(mn,t,1))}:vn?(on=(rn=new vn).port2,rn.port1.onmessage=gn,nn=a(on.postMessage,on,1)):o.addEventListener&&"function"==typeof postMessage&&!o.importScripts?(nn=function(t){o.postMessage(t+"","*")},o.addEventListener("message",gn,!1)):nn="onreadystatechange"in v("script")?function(t){Et.appendChild(v("script")).onreadystatechange=function(){Et.removeChild(this),mn.call(t)}}:function(t){setTimeout(a(mn,t,1),0)});var bn={set:hn,clear:pn},wn=bn.set,Cn=o.MutationObserver||o.WebKitMutationObserver,Sn=o.process,On=o.Promise,En="process"==T(Sn);function An(t){var e,n;this.promise=new t((function(t,r){if(void 0!==e||void 0!==n)throw TypeError("Bad Promise constructor");e=t,n=r})),this.resolve=c(e),this.reject=c(n)}var Pn,jn,Tn,In,xn,Ln,Rn={f:function(t){return new An(t)}},Dn=function(t){try{return{e:!1,v:t()}}catch(t){return{e:!0,v:t}}},Nn=o.navigator,kn=Nn&&Nn.userAgent||"",Mn=function(t,e){if(u(t),s(e)&&e.constructor===t)return e;var n=Rn.f(t);return(0,n.resolve)(e),n.promise},Fn=yt("species"),Wn=bn.set,Vn=function(){var t,e,n,r=function(){var r,o;for(En&&(r=Sn.domain)&&r.exit();t;){o=t.fn,t=t.next;try{o()}catch(r){throw t?n():e=void 0,r}}e=void 0,r&&r.enter()};if(En)n=function(){Sn.nextTick(r)};else if(!Cn||o.navigator&&o.navigator.standalone)if(On&&On.resolve){var i=On.resolve(void 0);n=function(){i.then(r)}}else n=function(){wn.call(o,r)};else{var c=!0,a=document.createTextNode("");new Cn(r).observe(a,{characterData:!0}),n=function(){a.data=c=!c}}return function(r){var o={fn:r,next:void 0};e&&(e.next=o),t||(t=o,n()),e=o}}(),Gn=o.TypeError,Kn=o.process,Yn=Kn&&Kn.versions,Bn=Yn&&Yn.v8||"",Un=o.Promise,qn="process"==ke(Kn),Hn=function(){},zn=jn=Rn.f,Jn=!!function(){try{var t=Un.resolve(1),e=(t.constructor={})[yt("species")]=function(t){t(Hn,Hn)};return(qn||"function"==typeof PromiseRejectionEvent)&&t.then(Hn)instanceof e&&0!==Bn.indexOf("6.6")&&-1===kn.indexOf("Chrome/66")}catch(t){}}(),Qn=function(t){var e;return!(!s(t)||"function"!=typeof(e=t.then))&&e},$n=function(t,e){if(!t._n){t._n=!0;var n=t._c;Vn((function(){for(var r=t._v,o=1==t._s,i=0,c=function(e){var n,i,c,a=o?e.ok:e.fail,s=e.resolve,u=e.reject,f=e.domain;try{a?(o||(2==t._h&&tr(t),t._h=1),!0===a?n=r:(f&&f.enter(),n=a(r),f&&(f.exit(),c=!0)),n===e.promise?u(Gn("Promise-chain cycle")):(i=Qn(n))?i.call(n,s,u):s(n)):u(r)}catch(t){f&&!c&&f.exit(),u(t)}};n.length>i;)c(n[i++]);t._c=[],t._n=!1,e&&!t._h&&Xn(t)}))}},Xn=function(t){Wn.call(o,(function(){var e,n,r,i=t._v,c=Zn(t);if(c&&(e=Dn((function(){qn?Kn.emit("unhandledRejection",i,t):(n=o.onunhandledrejection)?n({promise:t,reason:i}):(r=o.console)&&r.error&&r.error("Unhandled promise rejection",i)})),t._h=qn||Zn(t)?2:1),t._a=void 0,c&&e.e)throw e.v}))},Zn=function(t){return 1!==t._h&&0===(t._a||t._c).length},tr=function(t){Wn.call(o,(function(){var e;qn?Kn.emit("rejectionHandled",t):(e=o.onrejectionhandled)&&e({promise:t,reason:t._v})}))},er=function(t){var e=this;e._d||(e._d=!0,(e=e._w||e)._v=t,e._s=2,e._a||(e._a=e._c.slice()),$n(e,!0))},nr=function(t){var e,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===t)throw Gn("Promise can't be resolved itself");(e=Qn(t))?Vn((function(){var r={_w:n,_d:!1};try{e.call(t,a(nr,r,1),a(er,r,1))}catch(t){er.call(r,t)}})):(n._v=t,n._s=1,$n(n,!1))}catch(t){er.call({_w:n,_d:!1},t)}}};Jn||(Un=function(t){!function(t,e,n,r){if(!(t instanceof e)||void 0!==r&&r in t)throw TypeError(n+": incorrect invocation!")}(this,Un,"Promise","_h"),c(t),Pn.call(this);try{t(a(nr,this,1),a(er,this,1))}catch(t){er.call(this,t)}},(Pn=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=function(t,e,n){for(var r in e)n&&t[r]?t[r]=e[r]:b(t,r,e[r]);return t}(Un.prototype,{then:function(t,e){var n=zn(un(this,Un));return n.ok="function"!=typeof t||t,n.fail="function"==typeof e&&e,n.domain=qn?Kn.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&$n(this,!1),n.promise},catch:function(t){return this.then(void 0,t)}}),Tn=function(){var t=new Pn;this.promise=t,this.resolve=a(nr,t,1),this.reject=a(er,t,1)},Rn.f=zn=function(t){return t===Un||t===In?new Tn(t):jn(t)}),O(O.G+O.W+O.F*!Jn,{Promise:Un}),gt(Un,"Promise"),Ln="function"==typeof i[xn="Promise"]?i[xn]:o[xn],l&&Ln&&!Ln[Fn]&&m.f(Ln,Fn,{configurable:!0,get:function(){return this}}),In=i.Promise,O(O.S+O.F*!Jn,"Promise",{reject:function(t){var e=zn(this);return(0,e.reject)(t),e.promise}}),O(O.S+!0*O.F,"Promise",{resolve:function(t){return Mn(this===In?Un:this,t)}}),O(O.S+O.F*!(Jn&&$e((function(t){Un.all(t).catch(Hn)}))),"Promise",{all:function(t){var e=this,n=zn(e),r=n.resolve,o=n.reject,i=Dn((function(){var n=[],i=0,c=1;an(t,!1,(function(t){var a=i++,s=!1;n.push(void 0),c++,e.resolve(t).then((function(t){s||(s=!0,n[a]=t,--c||r(n))}),o)})),--c||r(n)}));return i.e&&o(i.v),n.promise},race:function(t){var e=this,n=zn(e),r=n.reject,o=Dn((function(){an(t,!1,(function(t){e.resolve(t).then(n.resolve,r)}))}));return o.e&&r(o.v),n.promise}}),O(O.P+O.R,"Promise",{finally:function(t){var e=un(this,i.Promise||o.Promise),n="function"==typeof t;return this.then(n?function(n){return Mn(e,t()).then((function(){return n}))}:t,n?function(n){return Mn(e,t()).then((function(){throw n}))}:t)}}),O(O.S,"Promise",{try:function(t){var e=Rn.f(this),n=Dn(t);return(n.e?e.reject:e.resolve)(n.v),e.promise}});var rr=i.Promise;var or=function(t,e,n){return e in t?P(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t};O(O.S,"Object",{create:Tt});var ir=i.Object,cr=function(t,e){return ir.create(t,e)};var ar=function(t,e){t.prototype=cr(e.prototype),t.prototype.constructor=t,t.__proto__=e},sr=r((function(t){var e=Object.prototype.hasOwnProperty,n="~";function r(){}function o(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function i(t,e,r,i,c){if("function"!=typeof r)throw new TypeError("The listener must be a function");var a=new o(r,i||t,c),s=n?n+e:e;return t._events[s]?t._events[s].fn?t._events[s]=[t._events[s],a]:t._events[s].push(a):(t._events[s]=a,t._eventsCount++),t}function c(t,e){0==--t._eventsCount?t._events=new r:delete t._events[e]}function a(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),a.prototype.eventNames=function(){var t,r,o=[];if(0===this._eventsCount)return o;for(r in t=this._events)e.call(t,r)&&o.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(t)):o},a.prototype.listeners=function(t){var e=n?n+t:t,r=this._events[e];if(!r)return[];if(r.fn)return[r.fn];for(var o=0,i=r.length,c=new Array(i);o<i;o++)c[o]=r[o].fn;return c},a.prototype.listenerCount=function(t){var e=n?n+t:t,r=this._events[e];return r?r.fn?1:r.length:0},a.prototype.emit=function(t,e,r,o,i,c){var a=n?n+t:t;if(!this._events[a])return!1;var s,u,f=this._events[a],l=arguments.length;if(f.fn){switch(f.once&&this.removeListener(t,f.fn,void 0,!0),l){case 1:return f.fn.call(f.context),!0;case 2:return f.fn.call(f.context,e),!0;case 3:return f.fn.call(f.context,e,r),!0;case 4:return f.fn.call(f.context,e,r,o),!0;case 5:return f.fn.call(f.context,e,r,o,i),!0;case 6:return f.fn.call(f.context,e,r,o,i,c),!0}for(u=1,s=new Array(l-1);u<l;u++)s[u-1]=arguments[u];f.fn.apply(f.context,s)}else{var h,p=f.length;for(u=0;u<p;u++)switch(f[u].once&&this.removeListener(t,f[u].fn,void 0,!0),l){case 1:f[u].fn.call(f[u].context);break;case 2:f[u].fn.call(f[u].context,e);break;case 3:f[u].fn.call(f[u].context,e,r);break;case 4:f[u].fn.call(f[u].context,e,r,o);break;default:if(!s)for(h=1,s=new Array(l-1);h<l;h++)s[h-1]=arguments[h];f[u].fn.apply(f[u].context,s)}}return!0},a.prototype.on=function(t,e,n){return i(this,t,e,n,!1)},a.prototype.once=function(t,e,n){return i(this,t,e,n,!0)},a.prototype.removeListener=function(t,e,r,o){var i=n?n+t:t;if(!this._events[i])return this;if(!e)return c(this,i),this;var a=this._events[i];if(a.fn)a.fn!==e||o&&!a.once||r&&a.context!==r||c(this,i);else{for(var s=0,u=[],f=a.length;s<f;s++)(a[s].fn!==e||o&&!a[s].once||r&&a[s].context!==r)&&u.push(a[s]);u.length?this._events[i]=1===u.length?u[0]:u:c(this,i)}return this},a.prototype.removeAllListeners=function(t){var e;return t?(e=n?n+t:t,this._events[e]&&c(this,e)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,t.exports=a}));function ur(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),P(t,r.key,r)}}var fr=function(t,e,n){return e&&ur(t.prototype,e),n&&ur(t,n),t},lr=r((function(t,e){var n;n={VERSION:"2.4.0",Result:{SUCCEEDED:1,NOTRANSITION:2,CANCELLED:3,PENDING:4},Error:{INVALID_TRANSITION:100,PENDING_TRANSITION:200,INVALID_CALLBACK:300},WILDCARD:"*",ASYNC:"async",create:function(t,e){var r="string"==typeof t.initial?{state:t.initial}:t.initial,o=t.terminal||t.final,i=e||t.target||{},c=t.events||[],a=t.callbacks||{},s={},u={},f=function(t){var e=Array.isArray(t.from)?t.from:t.from?[t.from]:[n.WILDCARD];s[t.name]=s[t.name]||{};for(var r=0;r<e.length;r++)u[e[r]]=u[e[r]]||[],u[e[r]].push(t.name),s[t.name][e[r]]=t.to||e[r];t.to&&(u[t.to]=u[t.to]||[])};r&&(r.event=r.event||"startup",f({name:r.event,from:"none",to:r.state}));for(var l=0;l<c.length;l++)f(c[l]);for(var h in s)s.hasOwnProperty(h)&&(i[h]=n.buildEvent(h,s[h]));for(var h in a)a.hasOwnProperty(h)&&(i[h]=a[h]);return i.current="none",i.is=function(t){return Array.isArray(t)?t.indexOf(this.current)>=0:this.current===t},i.can=function(t){return!this.transition&&void 0!==s[t]&&(s[t].hasOwnProperty(this.current)||s[t].hasOwnProperty(n.WILDCARD))},i.cannot=function(t){return!this.can(t)},i.transitions=function(){return(u[this.current]||[]).concat(u[n.WILDCARD]||[])},i.isFinished=function(){return this.is(o)},i.error=t.error||function(t,e,n,r,o,i,c){throw c||i},i.states=function(){return Object.keys(u).sort()},r&&!r.defer&&i[r.event](),i},doCallback:function(t,e,r,o,i,c){if(e)try{return e.apply(t,[r,o,i].concat(c))}catch(e){return t.error(r,o,i,c,n.Error.INVALID_CALLBACK,"an exception occurred in a caller-provided callback function",e)}},beforeAnyEvent:function(t,e,r,o,i){return n.doCallback(t,t.onbeforeevent,e,r,o,i)},afterAnyEvent:function(t,e,r,o,i){return n.doCallback(t,t.onafterevent||t.onevent,e,r,o,i)},leaveAnyState:function(t,e,r,o,i){return n.doCallback(t,t.onleavestate,e,r,o,i)},enterAnyState:function(t,e,r,o,i){return n.doCallback(t,t.onenterstate||t.onstate,e,r,o,i)},changeState:function(t,e,r,o,i){return n.doCallback(t,t.onchangestate,e,r,o,i)},beforeThisEvent:function(t,e,r,o,i){return n.doCallback(t,t["onbefore"+e],e,r,o,i)},afterThisEvent:function(t,e,r,o,i){return n.doCallback(t,t["onafter"+e]||t["on"+e],e,r,o,i)},leaveThisState:function(t,e,r,o,i){return n.doCallback(t,t["onleave"+r],e,r,o,i)},enterThisState:function(t,e,r,o,i){return n.doCallback(t,t["onenter"+o]||t["on"+o],e,r,o,i)},beforeEvent:function(t,e,r,o,i){if(!1===n.beforeThisEvent(t,e,r,o,i)||!1===n.beforeAnyEvent(t,e,r,o,i))return!1},afterEvent:function(t,e,r,o,i){n.afterThisEvent(t,e,r,o,i),n.afterAnyEvent(t,e,r,o,i)},leaveState:function(t,e,r,o,i){var c=n.leaveThisState(t,e,r,o,i),a=n.leaveAnyState(t,e,r,o,i);return!1!==c&&!1!==a&&(n.ASYNC===c||n.ASYNC===a?n.ASYNC:void 0)},enterState:function(t,e,r,o,i){n.enterThisState(t,e,r,o,i),n.enterAnyState(t,e,r,o,i)},buildEvent:function(t,e){return function(){var r=this.current,o=e[r]||(e[n.WILDCARD]!=n.WILDCARD?e[n.WILDCARD]:r)||r,i=Array.prototype.slice.call(arguments);if(this.transition)return this.error(t,r,o,i,n.Error.PENDING_TRANSITION,"event "+t+" inappropriate because previous transition did not complete");if(this.cannot(t))return this.error(t,r,o,i,n.Error.INVALID_TRANSITION,"event "+t+" inappropriate in current state "+this.current);if(!1===n.beforeEvent(this,t,r,o,i))return n.Result.CANCELLED;if(r===o)return n.afterEvent(this,t,r,o,i),n.Result.NOTRANSITION;var c=this;this.transition=function(){return c.transition=null,c.current=o,n.enterState(c,t,r,o,i),n.changeState(c,t,r,o,i),n.afterEvent(c,t,r,o,i),n.Result.SUCCEEDED},this.transition.cancel=function(){c.transition=null,n.afterEvent(c,t,r,o,i)};var a=n.leaveState(this,t,r,o,i);return!1===a?(this.transition=null,n.Result.CANCELLED):n.ASYNC===a?n.Result.PENDING:this.transition?this.transition():void 0}}},t.exports&&(e=t.exports=n),e.StateMachine=n})),hr=(lr.StateMachine,r((function(t,e){!function(e){var n=function(){},r=Object.prototype.hasOwnProperty,o=Object.create||function(t){var e=function(){};return e.prototype=t,new e},i=Object.keys||function(t){var e=[];for(var n in t)r.call(t,n)&&e.push(n);return e},c=function(t,e){for(var n in e)r.call(e,n)&&(t[n]=e[n]);return t},a=Object.setPrototypeOf||c,s=Object.prototype.toString,u=Array.isArray||function(t){return"[object Array]"===s.call(t)},f=function(t){return"[object Function]"===s.call(t)},l=!0,h={toString:""};for(var p in h)h.hasOwnProperty(p)&&(l=!1);var v=l?["toString","valueOf"]:null;function d(t,e,r){for(var o,c,a=function(t){var e=i(t);if(l)for(var n,r=0;n=v[r++];)t.hasOwnProperty(n)&&e.push(n);return e}(r),s=0,u=a.length;s<u;)"__self"!==(o=a[s++])&&(c=r[o],f(c)&&(!c.prototype||!c.prototype.__self)&&c.toString().indexOf(".__base")>-1?e[o]=function(r,o){var i=t[r]?t[r]:"__constructor"===r?e.__self.__parent:n,c=function(){var t=this.__base;this.__base=c.__base;var e=o.apply(this,arguments);return this.__base=t,e};return c.__base=i,c}(o,c):e[o]=c)}function y(t,e){for(var n,r=1;n=t[r++];)e?f(n)?_.self(e,n.prototype,n):_.self(e,n):e=f(n)?_(t[0],n.prototype,n):_(t[0],n);return e||t[0]}function _(){var t=arguments,e=u(t[0]),r=e||f(t[0]),i=r?e?y(t[0]):t[0]:n,s=t[r?1:0]||{},l=t[r?2:1],h=s.__constructor||r&&i.prototype&&i.prototype.__constructor?function(){return this.__constructor.apply(this,arguments)}:r?function(){return i.apply(this,arguments)}:function(){};if(!r)return h.prototype=s,h.prototype.__self=h.prototype.constructor=h,c(h,l);a(h,i),h.__parent=i;var p=i.prototype,v=h.prototype=o(p);return v.__self=v.constructor=h,s&&d(p,v,s),l&&d(i,h,l),h}_.self=function(){var t=arguments,e=u(t[0]),n=e?y(t[0],t[0][0]):t[0],r=t[1],o=t[2],i=n.prototype;return r&&d(i,i,r),o&&d(n,n,o),n};var m=!0;t.exports=_,m=!1,"object"==typeof modules&&"function"==typeof modules.define&&(modules.define("inherit",(function(t){t(_)})),m=!1),m&&(e.inherit=_)}(n)})));if(!e.TypedMessage)throw new Error("LeanCloud Realtime SDK not installed");var pr,vr=hr(e.TypedMessage,{__constructor:function(t){this.__base(),this.payload=t}});vr.sendOptions={transient:!0},e.messageField("payload")(vr);var dr,yr,_r,mr,gr=e.messageType(-102)(pr=function(t){function e(){return t.apply(this,arguments)||this}return ar(e,t),e}(vr))||pr,br=e.messageType(-103)(dr=function(t){function e(){return t.apply(this,arguments)||this}return ar(e,t),e}(vr))||dr,wr=e.messageType(-104)(yr=function(t){function e(){return t.apply(this,arguments)||this}return ar(e,t),e}(vr))||yr,Cr=e.messageType(-105)(_r=function(t){function e(){return t.apply(this,arguments)||this}return ar(e,t),e}(vr))||_r,Sr=function(t){function e(e,n){var r;(r=t.call(this)||this)._setConversation(e),r._peerConnection=r._createPeerConnection(n),r._call=lr.create({initial:"calling",events:[{name:"connect",from:"calling",to:"connected"},{name:"close",from:"connected",to:"closed"},{name:"cancel",from:"calling",to:"canceled"},{name:"refuse",from:"calling",to:"refused"}]}),r._promises={};var o=new rr((function(t){r._promises.resolveStreamReady=t})),i=new rr((function(t){r._promises.resolveAccept=t}));return rr.all([o,i]).then((function(t){var e=cn(t,1)[0];r._call.can("connect")&&(r._call.connect(),r.emit("connect",e))})),r}ar(e,t);var n=e.prototype;return n.close=function(){var t=this;return rr.resolve().then((function(){t._call.close(),t._destroyPeerConnection(),t._peerConnection.close(),t._destroy()}))},n._handleCloseEvent=function(){this._call.can("close")&&(this.close(),this.emit("close"))},n._setConversation=function(t){this._conversation&&this._conversation.off("message"),t&&(this._conversation=t,t.on("message",this._handleMessage.bind(this)))},n._destroy=function(){this._conversation.off("message")},n._createPeerConnection=function(t){var e=new RTCPeerConnection(t);return e.onicecandidate=this._handleICECandidateEvent.bind(this),e.onaddstream=this._handleAddStreamEvent.bind(this),e.onnremovestream=this._handleRemoveStreamEvent.bind(this),e.oniceconnectionstatechange=this._handleICEConnectionStateChangeEvent.bind(this),e.onsignalingstatechange=this._handleSignalingStateChangeEvent.bind(this),e},n._destroyPeerConnection=function(){var t=this._peerConnection;delete t.onaddstream,delete t.onremovestream,delete t.onnicecandidate,delete t.oniceconnectionstatechange,delete t.onsignalingstatechange},n._handleMessage=function(t){return t instanceof gr?this._handleAnswer(t):t instanceof wr?this._handleRefusal():t instanceof Cr?this._handleCancelation():t instanceof br&&this._handleICECandidate(t)},n._handleICECandidate=function(t){var e=new RTCIceCandidate(t.payload);this._peerConnection&&this._peerConnection.addIceCandidate(e).catch(console.error.bind(console))},n._handleICECandidateEvent=function(t){return!(!t.candidate||!this._conversation)&&this._conversation.send(new br(t.candidate)).catch(console.error.bind(console))},n._handleAddStreamEvent=function(t){this._promises.resolveStreamReady(t.stream)},n._handleRemoveStreamEvent=function(){this._handleCloseEvent()},n._handleICEConnectionStateChangeEvent=function(){switch(this._peerConnection.iceConnectionState){case"closed":case"failed":case"disconnected":this._handleCloseEvent()}},n._handleSignalingStateChangeEvent=function(){switch(this._peerConnection.signalingState){case"closed":this._handleCloseEvent()}},n._handleAnswer=function(){throw new Error("not implemented")},n._handleRefusal=function(){throw new Error("not implemented")},n._handleCancelation=function(){throw new Error("not implemented")},fr(e,[{key:"state",get:function(){return this._call.current}}]),e}(sr),Or=function(t){function e(e,n,r){var o;return(o=t.call(this,n,r)||this).to=e,o}ar(e,t);var n=e.prototype;return n._handleAnswer=function(t){var e=new RTCSessionDescription(t.payload);this._peerConnection.setRemoteDescription(e),this._promises.resolveAccept()},n._handleRefusal=function(){this._destroyPeerConnection(),this._call.refuse(),this.emit("refuse"),this._destroy()},n.cancel=function(){var t=this;return this._call.cancel(),this._conversation.send(new Cr).then((function(){return t._destroy()}))},n.close=function(){return this._call.can("cancel")?this.cancel():t.prototype.close.call(this)},e}(Sr),Er=function(t){function e(e,n,r){var o;(o=t.call(this,n,r)||this).from=e.from;var i=new RTCSessionDescription(e.payload);return o._handleOfferPromise=o._peerConnection.setRemoteDescription(i),o}ar(e,t);var n=e.prototype;return n.accept=function(t){var e=this;if(!t)throw new TypeError("a MediaStream instance is required to accept a call");return this._handleOfferPromise.then((function(){return e._peerConnection.addStream(t)})).then((function(){return e._peerConnection.createAnswer()})).then((function(t){return e._peerConnection.setLocalDescription(t)})).then((function(){return e._conversation.send(new gr(e._peerConnection.localDescription))})).then((function(){return e._promises.resolveAccept()}))},n.refuse=function(){var t=this;return this._conversation.send(new wr).then((function(){t._call.refuse(),t._destroy()}))},n._handleCancelation=function(){this._call.cancel(),this.emit("cancel"),this._destroy()},e}(Sr),Ar=e.messageType(-101)(mr=function(t){function e(){return t.apply(this,arguments)||this}return ar(e,t),e}(vr))||mr;function Pr(t,e){var n=he(t);if(fe){var r=fe(t);e&&(r=r.filter((function(e){return pt(t,e).enumerable}))),n.push.apply(n,r)}return n}var jr={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:stun1.l.google.com:19302","stun:stun2.l.google.com:19302","stun:stun3.l.google.com:19302","stun:stun4.l.google.com:19302","stun:stun.ekiga.net","stun:stun.ideasip.com","stun:stun.rixtelecom.se","stun:stun.schlund.de","stun:stun.stunprotocol.org:3478","stun:stun.voiparound.com","stun:stun.voipbuster.com","stun:stun.voipstunt.com","stun:stun.voxgratia.org"]}]},Tr=function(t){function e(e,n){var r;if("string"!=typeof e)throw new TypeError("id is not a string");return(r=t.call(this)||this).id=e,r.options=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Pr(Object(n),!0).forEach((function(e){or(t,e,n[e])})):ut?Z(t,ut(n)):Pr(Object(n)).forEach((function(e){P(t,e,pt(n,e))}))}return t}({RTCConfiguration:jr},n),r}ar(e,t);var n=e.prototype;return n._open=function(t,e){var n=this;return t.createIMClient(this.id,e,"webrtc").then((function(t){return n._imClient=t,n.id=t.id,t.on("message",(function(t,e){return t instanceof Ar&&n._handleOffer(t,e)})),t.on("conflict",(function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return n.emit.apply(n,["conflict"].concat(e))})),n}))},n.close=function(){return this._imClient.close()},n.call=function(t,e){var n=this;if("string"!=typeof t)throw new TypeError("target id is not a string");if(!e)throw new TypeError("a MediaStream instance is required to make a call");return this._imClient.ping([t]).then((function(r){if(!r.length)throw new Error("Call failed as ".concat(t," is not online"));var o=new Or(t,null,n.options.RTCConfiguration),i=new rr((function(t){o._peerConnection.onnegotiationneeded=t}));return o._peerConnection.addStream(e),i.then((function(){return rr.all([n._imClient.createConversation({members:[t],unique:!0}),o._peerConnection.createOffer().then((function(t){o._peerConnection.setLocalDescription(t)}))])})).then((function(t){var e=cn(t,1)[0];return o._setConversation(e),e.send(new Ar(o._peerConnection.localDescription))})).then((function(){return o}))}))},n._handleOffer=function(t,e){var n=new Er(t,e,this.options.RTCConfiguration);this.emit("call",n)},e}(sr),Ir={name:"leancloud-realtime-plugin-webrtc",messageClasses:[Ar,gr,br,wr,Cr],onRealtimeCreate:function(t){t.createWebRTCClient=function(e,n){return new Tr(e)._open(t,n)}}},xr=!!(window.RTCPeerConnection&&window.RTCSessionDescription&&window.RTCIceCandidate);t.WebRTCPlugin=Ir,t.isWebRTCSupported=xr,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=webrtc.min.js.map
