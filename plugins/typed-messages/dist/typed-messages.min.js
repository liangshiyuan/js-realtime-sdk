!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("leancloud-storage"),require("leancloud-realtime")):"function"==typeof define&&define.amd?define("typed-messages",["exports","leancloud-storage","leancloud-realtime"],e):e((t=t||self).AV=t.AV||{},t.AV,t.AV)}(this,(function(t,e,r){"use strict";function n(t,e){return t(e={exports:{}},e.exports),e.exports}var o=n((function(t){var e=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e)})),i=n((function(t){var e=t.exports={version:"2.6.5"};"number"==typeof __e&&(__e=e)})),u=(i.version,function(t,e,r){if(function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!")}(t),void 0===e)return t;switch(r){case 1:return function(r){return t.call(e,r)};case 2:return function(r,n){return t.call(e,r,n)};case 3:return function(r,n,o){return t.call(e,r,n,o)}}return function(){return t.apply(e,arguments)}}),a=function(t){return"object"==typeof t?null!==t:"function"==typeof t},c=function(t){if(!a(t))throw TypeError(t+" is not an object!");return t},f=function(t){try{return!!t()}catch(t){return!0}},s=!f((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})),l=o.document,p=a(l)&&a(l.createElement),y=function(t){return p?l.createElement(t):{}},m=!s&&!f((function(){return 7!=Object.defineProperty(y("div"),"a",{get:function(){return 7}}).a})),h=function(t,e){if(!a(t))return t;var r,n;if(e&&"function"==typeof(r=t.toString)&&!a(n=r.call(t)))return n;if("function"==typeof(r=t.valueOf)&&!a(n=r.call(t)))return n;if(!e&&"function"==typeof(r=t.toString)&&!a(n=r.call(t)))return n;throw TypeError("Can't convert object to primitive value")},b=Object.defineProperty,g={f:s?Object.defineProperty:function(t,e,r){if(c(t),e=h(e,!0),c(r),m)try{return b(t,e,r)}catch(t){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(t[e]=r.value),t}},v=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},d=s?function(t,e,r){return g.f(t,e,v(1,r))}:function(t,e,r){return t[e]=r,t},O={}.hasOwnProperty,w=function(t,e){return O.call(t,e)},_=function(t,e,r){var n,a,c,f=t&_.F,s=t&_.G,l=t&_.S,p=t&_.P,y=t&_.B,m=t&_.W,h=s?i:i[e]||(i[e]={}),b=h.prototype,g=s?o:l?o[e]:(o[e]||{}).prototype;for(n in s&&(r=e),r)(a=!f&&g&&void 0!==g[n])&&w(h,n)||(c=a?g[n]:r[n],h[n]=s&&"function"!=typeof g[n]?r[n]:y&&a?u(c,o):m&&g[n]==c?function(t){var e=function(e,r,n){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,r)}return new t(e,r,n)}return t.apply(this,arguments)};return e.prototype=t.prototype,e}(c):p&&"function"==typeof c?u(Function.call,c):c,p&&((h.virtual||(h.virtual={}))[n]=c,t&_.R&&b&&!b[n]&&d(b,n,c)))};_.F=1,_.G=2,_.S=4,_.P=8,_.B=16,_.W=32,_.U=64,_.R=128;var j=_;j(j.S+j.F*!s,"Object",{defineProperty:g.f});var S,E=i.Object,P=function(t,e,r){return E.defineProperty(t,e,r)},F={}.toString,T=function(t){return F.call(t).slice(8,-1)},M=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==T(t)?t.split(""):Object(t)},D=function(t){if(null==t)throw TypeError("Can't call method on  "+t);return t},N=function(t){return M(D(t))},k=Math.ceil,x=Math.floor,I=function(t){return isNaN(t=+t)?0:(t>0?x:k)(t)},C=Math.min,A=Math.max,J=Math.min,K=n((function(t){var e=o["__core-js_shared__"]||(o["__core-js_shared__"]={});(t.exports=function(t,r){return e[t]||(e[t]=void 0!==r?r:{})})("versions",[]).push({version:i.version,mode:"pure",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})})),R=0,W=Math.random(),V=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++R+W).toString(36))},G=K("keys"),L=function(t){return G[t]||(G[t]=V(t))},z=(S=!1,function(t,e,r){var n,o,i=N(t),u=(n=i.length)>0?C(I(n),9007199254740991):0,a=function(t,e){return(t=I(t))<0?A(t+e,0):J(t,e)}(r,u);if(S&&e!=e){for(;u>a;)if((o=i[a++])!=o)return!0}else for(;u>a;a++)if((S||a in i)&&i[a]===e)return S||a||0;return!S&&-1}),q=L("IE_PROTO"),Y=function(t,e){var r,n=N(t),o=0,i=[];for(r in n)r!=q&&w(n,r)&&i.push(r);for(;e.length>o;)w(n,r=e[o++])&&(~z(i,r)||i.push(r));return i},B="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),Q=Object.keys||function(t){return Y(t,B)},U=s?Object.defineProperties:function(t,e){c(t);for(var r,n=Q(e),o=n.length,i=0;o>i;)g.f(t,r=n[i++],e[r]);return t};j(j.S+j.F*!s,"Object",{defineProperties:U});var H=i.Object,X=function(t,e){return H.defineProperties(t,e)},Z=B.concat("length","prototype"),$={f:Object.getOwnPropertyNames||function(t){return Y(t,Z)}},tt={f:Object.getOwnPropertySymbols},et=o.Reflect,rt=et&&et.ownKeys||function(t){var e=$.f(c(t)),r=tt.f;return r?e.concat(r(t)):e},nt={f:{}.propertyIsEnumerable},ot=Object.getOwnPropertyDescriptor,it={f:s?ot:function(t,e){if(t=N(t),e=h(e,!0),m)try{return ot(t,e)}catch(t){}if(w(t,e))return v(!nt.f.call(t,e),t[e])}},ut=function(t,e,r){e in t?g.f(t,e,v(0,r)):t[e]=r};j(j.S,"Object",{getOwnPropertyDescriptors:function(t){for(var e,r,n=N(t),o=it.f,i=rt(n),u={},a=0;i.length>a;)void 0!==(r=o(n,e=i[a++]))&&ut(u,e,r);return u}});var at=i.Object.getOwnPropertyDescriptors,ct=function(t,e){var r=(i.Object||{})[t]||Object[t],n={};n[t]=e(r),j(j.S+j.F*f((function(){r(1)})),"Object",n)},ft=it.f;ct("getOwnPropertyDescriptor",(function(){return function(t,e){return ft(N(t),e)}}));var st=i.Object,lt=function(t,e){return st.getOwnPropertyDescriptor(t,e)},pt=d,yt=n((function(t){var e=V("meta"),r=g.f,n=0,o=Object.isExtensible||function(){return!0},i=!f((function(){return o(Object.preventExtensions({}))})),u=function(t){r(t,e,{value:{i:"O"+ ++n,w:{}}})},c=t.exports={KEY:e,NEED:!1,fastKey:function(t,r){if(!a(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!w(t,e)){if(!o(t))return"F";if(!r)return"E";u(t)}return t[e].i},getWeak:function(t,r){if(!w(t,e)){if(!o(t))return!0;if(!r)return!1;u(t)}return t[e].w},onFreeze:function(t){return i&&c.NEED&&o(t)&&!w(t,e)&&u(t),t}}})),mt=(yt.KEY,yt.NEED,yt.fastKey,yt.getWeak,yt.onFreeze,n((function(t){var e=K("wks"),r=o.Symbol,n="function"==typeof r;(t.exports=function(t){return e[t]||(e[t]=n&&r[t]||(n?r:V)("Symbol."+t))}).store=e}))),ht=g.f,bt=mt("toStringTag"),gt=function(t,e,r){t&&!w(t=r?t:t.prototype,bt)&&ht(t,bt,{configurable:!0,value:e})},vt={f:mt},dt=g.f,Ot=function(t){var e=i.Symbol||(i.Symbol={});"_"==t.charAt(0)||t in e||dt(e,t,{value:vt.f(t)})},wt=Array.isArray||function(t){return"Array"==T(t)},_t=o.document,jt=_t&&_t.documentElement,St=L("IE_PROTO"),Et=function(){},Pt=function(){var t,e=y("iframe"),r=B.length;for(e.style.display="none",jt.appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),Pt=t.F;r--;)delete Pt.prototype[B[r]];return Pt()},Ft=Object.create||function(t,e){var r;return null!==t?(Et.prototype=c(t),r=new Et,Et.prototype=null,r[St]=t):r=Pt(),void 0===e?r:U(r,e)},Tt=$.f,Mt={}.toString,Dt="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],Nt={f:function(t){return Dt&&"[object Window]"==Mt.call(t)?function(t){try{return Tt(t)}catch(t){return Dt.slice()}}(t):Tt(N(t))}},kt=yt.KEY,xt=it.f,It=g.f,Ct=Nt.f,At=o.Symbol,Jt=o.JSON,Kt=Jt&&Jt.stringify,Rt=mt("_hidden"),Wt=mt("toPrimitive"),Vt={}.propertyIsEnumerable,Gt=K("symbol-registry"),Lt=K("symbols"),zt=K("op-symbols"),qt=Object.prototype,Yt="function"==typeof At,Bt=o.QObject,Qt=!Bt||!Bt.prototype||!Bt.prototype.findChild,Ut=s&&f((function(){return 7!=Ft(It({},"a",{get:function(){return It(this,"a",{value:7}).a}})).a}))?function(t,e,r){var n=xt(qt,e);n&&delete qt[e],It(t,e,r),n&&t!==qt&&It(qt,e,n)}:It,Ht=function(t){var e=Lt[t]=Ft(At.prototype);return e._k=t,e},Xt=Yt&&"symbol"==typeof At.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof At},Zt=function(t,e,r){return t===qt&&Zt(zt,e,r),c(t),e=h(e,!0),c(r),w(Lt,e)?(r.enumerable?(w(t,Rt)&&t[Rt][e]&&(t[Rt][e]=!1),r=Ft(r,{enumerable:v(0,!1)})):(w(t,Rt)||It(t,Rt,v(1,{})),t[Rt][e]=!0),Ut(t,e,r)):It(t,e,r)},$t=function(t,e){c(t);for(var r,n=function(t){var e=Q(t),r=tt.f;if(r)for(var n,o=r(t),i=nt.f,u=0;o.length>u;)i.call(t,n=o[u++])&&e.push(n);return e}(e=N(e)),o=0,i=n.length;i>o;)Zt(t,r=n[o++],e[r]);return t},te=function(t){var e=Vt.call(this,t=h(t,!0));return!(this===qt&&w(Lt,t)&&!w(zt,t))&&(!(e||!w(this,t)||!w(Lt,t)||w(this,Rt)&&this[Rt][t])||e)},ee=function(t,e){if(t=N(t),e=h(e,!0),t!==qt||!w(Lt,e)||w(zt,e)){var r=xt(t,e);return!r||!w(Lt,e)||w(t,Rt)&&t[Rt][e]||(r.enumerable=!0),r}},re=function(t){for(var e,r=Ct(N(t)),n=[],o=0;r.length>o;)w(Lt,e=r[o++])||e==Rt||e==kt||n.push(e);return n},ne=function(t){for(var e,r=t===qt,n=Ct(r?zt:N(t)),o=[],i=0;n.length>i;)!w(Lt,e=n[i++])||r&&!w(qt,e)||o.push(Lt[e]);return o};Yt||(pt((At=function(){if(this instanceof At)throw TypeError("Symbol is not a constructor!");var t=V(arguments.length>0?arguments[0]:void 0),e=function(r){this===qt&&e.call(zt,r),w(this,Rt)&&w(this[Rt],t)&&(this[Rt][t]=!1),Ut(this,t,v(1,r))};return s&&Qt&&Ut(qt,t,{configurable:!0,set:e}),Ht(t)}).prototype,"toString",(function(){return this._k})),it.f=ee,g.f=Zt,$.f=Nt.f=re,nt.f=te,tt.f=ne,vt.f=function(t){return Ht(mt(t))}),j(j.G+j.W+j.F*!Yt,{Symbol:At});for(var oe="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),ie=0;oe.length>ie;)mt(oe[ie++]);for(var ue=Q(mt.store),ae=0;ue.length>ae;)Ot(ue[ae++]);j(j.S+j.F*!Yt,"Symbol",{for:function(t){return w(Gt,t+="")?Gt[t]:Gt[t]=At(t)},keyFor:function(t){if(!Xt(t))throw TypeError(t+" is not a symbol!");for(var e in Gt)if(Gt[e]===t)return e},useSetter:function(){Qt=!0},useSimple:function(){Qt=!1}}),j(j.S+j.F*!Yt,"Object",{create:function(t,e){return void 0===e?Ft(t):$t(Ft(t),e)},defineProperty:Zt,defineProperties:$t,getOwnPropertyDescriptor:ee,getOwnPropertyNames:re,getOwnPropertySymbols:ne}),Jt&&j(j.S+j.F*(!Yt||f((function(){var t=At();return"[null]"!=Kt([t])||"{}"!=Kt({a:t})||"{}"!=Kt(Object(t))}))),"JSON",{stringify:function(t){for(var e,r,n=[t],o=1;arguments.length>o;)n.push(arguments[o++]);if(r=e=n[1],(a(e)||void 0!==t)&&!Xt(t))return wt(e)||(e=function(t,e){if("function"==typeof r&&(e=r.call(this,t,e)),!Xt(e))return e}),n[1]=e,Kt.apply(Jt,n)}}),At.prototype[Wt]||d(At.prototype,Wt,At.prototype.valueOf),gt(At,"Symbol"),gt(Math,"Math",!0),gt(o.JSON,"JSON",!0);var ce=i.Object.getOwnPropertySymbols,fe=function(t){return Object(D(t))};ct("keys",(function(){return function(t){return Q(fe(t))}}));var se=i.Object.keys;var le=function(t,e,r){return e in t?P(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t},pe=Object.assign,ye=!pe||f((function(){var t={},e={},r=Symbol(),n="abcdefghijklmnopqrst";return t[r]=7,n.split("").forEach((function(t){e[t]=t})),7!=pe({},t)[r]||Object.keys(pe({},e)).join("")!=n}))?function(t,e){for(var r=fe(t),n=arguments.length,o=1,i=tt.f,u=nt.f;n>o;)for(var a,c=M(arguments[o++]),f=i?Q(c).concat(i(c)):Q(c),s=f.length,l=0;s>l;)u.call(c,a=f[l++])&&(r[a]=c[a]);return r}:pe;j(j.S+j.F,"Object",{assign:ye});var me=i.Object.assign;function he(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),P(t,n.key,n)}}var be=function(t,e,r){return e&&he(t.prototype,e),r&&he(t,r),t};j(j.S,"Object",{create:Ft});var ge=i.Object,ve=function(t,e){return ge.create(t,e)};var de=function(t,e){t.prototype=ve(e.prototype),t.prototype.constructor=t,t.__proto__=e};if(!e.File)throw new Error("LeanCloud Storage SDK not installed");if(!r.TypedMessage)throw new Error("LeanCloud Realtime SDK not installed");function Oe(t,e){var r=se(t);if(ce){var n=ce(t);e&&(n=n.filter((function(e){return lt(t,e).enumerable}))),r.push.apply(r,n)}return r}var we=function(t){function n(r){var n;if(!(r instanceof e.File))throw new TypeError("file must be an AV.File");if("string"!=typeof r.id)throw new Error("file must be saved before used to create a Message");return(n=t.call(this)||this)._file=r,n._lcfile={objId:r.id,url:r.url(),metaData:me(r.metaData()||{},{name:r.name()})},n}de(n,t);var o=n.prototype;return o.getFile=function(){return this._file},o.toJSON=function(){return function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Oe(Object(r),!0).forEach((function(e){le(t,e,r[e])})):at?X(t,at(r)):Oe(Object(r)).forEach((function(e){P(t,e,lt(r,e))}))}return t}({},t.prototype.toJSON.call(this),{file:this.getFile().toJSON()})},n._parseFileFromRawData=function(t){if(!t||!t._lcfile)throw new Error("malformed FileMessage content");var r=t._lcfile.objId;"string"!=typeof r&&(r="");var n=e.File.createWithoutData(r);return n.attributes=n.attributes||{},n._url=t._lcfile.url,n.attributes.url=n._url,n._metaData=t._lcfile.metaData||{},n.attributes.metaData=n._metaData,t._lcfile.metaData&&(n._name=t._lcfile.metaData.name,n.attributes.name=n._name),n},n.parse=function(t,e){var n=this._parseFileFromRawData(t);return r.TypedMessage.parse(t,e||new this(n))},be(n,[{key:"summary",get:function(){return"[".concat(this.constructor._summaryType,"] ").concat(this._file.name()||"").trim()}}]),n}(r.TypedMessage);we._summaryType="文件",r.messageType(-6)(we),r.messageField("_lcfile")(we),r.IE10Compatible(we);var _e=function(t){function e(){return t.apply(this,arguments)||this}return de(e,t),e}(we);_e._summaryType="图片",r.messageType(-2)(_e),r.IE10Compatible(_e);var je=function(t){function e(){return t.apply(this,arguments)||this}return de(e,t),e}(we);je._summaryType="语音",r.messageType(-3)(je),r.IE10Compatible(je);var Se=function(t){function e(){return t.apply(this,arguments)||this}return de(e,t),e}(we);function Ee(t,e){var r=se(t);if(ce){var n=ce(t);e&&(n=n.filter((function(e){return lt(t,e).enumerable}))),r.push.apply(r,n)}return r}Se._summaryType="视频",r.messageType(-4)(Se),r.IE10Compatible(Se);var Pe=function(t){function n(r){var n;if(!(r instanceof e.GeoPoint))throw new TypeError("geoPoint must be an AV.GeoPoint");(n=t.call(this)||this)._geoPoint=r;var o=r.latitude,i=r.longitude;return n._lcloc={latitude:o,longitude:i},n}de(n,t);var o=n.prototype;return o.getLocation=function(){return this._geoPoint},o.toJSON=function(){return function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Ee(Object(r),!0).forEach((function(e){le(t,e,r[e])})):at?X(t,at(r)):Ee(Object(r)).forEach((function(e){P(t,e,lt(r,e))}))}return t}({},t.prototype.toJSON.call(this),{location:this.getLocation().toJSON()})},n.parse=function(t,n){var o=t._lcloc,i=o.latitude,u=o.longitude,a=new e.GeoPoint({latitude:i,longitude:u});return r.TypedMessage.parse(t,n||new this(a))},be(n,[{key:"summary",get:function(){return"[位置] ".concat(this.text||"").trim()}}]),n}(r.TypedMessage);r.messageType(-5)(Pe),r.messageField("_lcloc")(Pe),r.IE10Compatible(Pe);var Fe={name:"leancloud-realtime-plugin-typed-messages",messageClasses:[we,_e,je,Se,Pe]};t.AudioMessage=je,t.FileMessage=we,t.ImageMessage=_e,t.LocationMessage=Pe,t.TypedMessagesPlugin=Fe,t.VideoMessage=Se,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=typed-messages.min.js.map
